---
title: "outlin_graphs"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(kableExtra)
library(formattable)
library(knitr)
library(MatchIt)
library(tableone)
library(gridExtra)

land_17_18_19 <- read.csv("~/R/Saptari/data/land_17_18_19.csv")
Land_18_19 <- read.csv("~/R/Rautahat.Bara.Sarlahi/data/Land_18_19.csv")
Agriculture_17_18_19 <- read.csv("~/R/Saptari/data/Agriculture_17_18_19.csv")
Agriculture_18_19 <- read.csv("~/R/Rautahat.Bara.Sarlahi/data/Agriculture_18_19.csv")
Procurement_17_18_19 <- read.csv("~/R/Saptari/data/Procurement_17_18_19.csv")
Procurement_18_19 <- read.csv("~/R/Rautahat.Bara.Sarlahi/data/Procurement_18_19.csv")
wem_liter_fuel_17_18_19 <- read.csv("~/R/Saptari/data/wem_liter_fuel_17_18_19.csv")
wem_liter_fuel_18_19 <-read.csv("~/R/Rautahat.Bara.Sarlahi/data/wem_liter_fuel_18_19.csv")
lands_I_17_18_19 <- read.csv("~/R/Saptari/data/lands_I_17_18_19.csv")
lands_I_18_19 <-read.csv("~/R/Rautahat.Bara.Sarlahi/data/lands_I_18_19.csv")


```

 - The total own land cultivated  for a houshold in Summer (ha) 

 - Gross Cropped Area (ha)  

 - Cropping Intensity (%)  

 - Irrigated land (ha)  

 - Time taken to irrigation per hectar (hr) Annual/seasons  

 - Fuel use - Annual (in litre) [file - 7.16]  

 - Fuel use - Annual/seasons (in litre) [file - 6.2]  

 - Aquaculture ponds (ha)  

 - Cropping Pattern - Vegetables,Oilseeds, Paddy, Wheat, Maize (ha)  

 - Annual income  
 
 &nbsp;

 
Number of SPIP in each district
```{r sip, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%" }

sip  <-tribble(~" ", ~"Control", ~"Treatment",
               "Saptari", 107, 26, 
               "Rautahat Bara Sarlahi" ,95, 23 )

kable(sip, "latex",booktabs= T, align = "lcc") %>% kable_styling(bootstrap_options = c("striped", "hover"), position = "left")

```

&nbsp;

&nbsp;

\noindent
\makebox[\linewidth]{ The total own land cultivated  for a houshold in Summer (ha) }
The total own land cultivated  for a houshold in  **Summer** season (In hectare)  
**Q** [4.4] _total_ownland_cultivated_  
```{r ownland, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%" }

own_saptari <-
  land_17_18_19 %>% 
  filter(total_land_cultivated_year>0,season=="Summer") %>%
  group_by(year,TreatmentControl, household_questionnaire_id) %>%
  summarise(own=sum(total_ownland_cultivated)*0.0338)

names(own_saptari)[names(own_saptari) == 'TreatmentControl'] <- 'Group'

lso <-
  own_saptari %>% filter(own>0) %>% 
  mutate(after_1Y = year == 2018, 
       after_2Y = year == 2019, 
       own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ own , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,own) %>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(own_saptari,df.match)

ggplot(df, aes(year, own, color = Group))+
  stat_summary(geom = 'line',size=1) +
  theme_minimal()+
  labs(x=" ", y="Ownland cultivated - Summer") +
  scale_x_continuous(breaks = c(2017,2018,2019))+ 
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))
#---------------------------------------------------------------------------------
own_rbs <- 
  Land_18_19%>% 
  filter(total_land_cultivated_year>0,season=="Summer") %>%
  group_by(year,TreatmentControl, household_questionnaire_id) %>%
  summarise(own=total_ownland_cultivated*0.0338) 
names(own_rbs)[names(own_rbs) == 'TreatmentControl'] <- 'Group'

lso <-
  own_rbs %>% mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ own , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,own)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(own_rbs,df.match)

ggplot(df, aes(year, own, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ",y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))

```



&nbsp;

&nbsp;


\noindent
\makebox[\linewidth]{Gross Cropped Area (ha)}  
The total cultivated area for a year in hectare:  
the area sown in monsoon + winter + summer + annual - all together  
 Q[4.8] _total_land_cultivated_
```{r Gross Cropped Area, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%" }
lsc <- 
  land_17_18_19%>% 
  filter(total_land_cultivated_year>0) %>%
  group_by(year,TreatmentControl, household_questionnaire_id) %>%
  summarise(cult=sum(total_land_cultivated)*0.0338)

names(lsc)[names(lsc) == 'TreatmentControl'] <- 'Group'

lso <-
  lsc %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ cult , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,cult)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(lsc,df.match)

ggplot(df, aes(year, cult, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="Gross Cropped Area") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


#------------------------------------------------------------------------------------------
lsr <- Land_18_19%>% 
  filter(total_land_cultivated_year>0) %>%
  group_by(year,TreatmentControl, household_questionnaire_id) %>%
  summarise(cult=sum(total_land_cultivated)*0.0338)

names(lsr)[names(lsr) == 'TreatmentControl'] <- 'Group'

lso <-
  lsr %>% mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ cult , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,cult)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(lsr,df.match)

ggplot(df, aes(year, cult, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ",y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))
```


&nbsp;

&nbsp;

\noindent
\makebox[\linewidth]{Cropping Intensity (\%)}

Gross cropped Area / Net Cropped Area X100  

sum ( _total_land_cultivated_ [4.8] ) / _land_for_cultivation_ [4.1e] 
```{r Cropping Intensity ,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}

lsci <- land_17_18_19%>% filter(total_land_cultivated_year>0) %>%
  mutate(NEW_total_land_cult= case_when(TreatmentControl=="Control" & land_for_cultivation < total_land_cultivated ~ NA_real_,
                                        TRUE ~ total_land_cultivated)) %>% 
  group_by(year,TreatmentControl, household_questionnaire_id) %>%
  summarise(cult=sum(NEW_total_land_cult,na.rm = T),net=mean(land_for_cultivation))%>%
  mutate(crop_intensity=cult/net*100) %>% 
  mutate(across(is.numeric, round))

names(lsci)[names(lsci) == 'TreatmentControl'] <- 'Group'

lso <-
  lsci %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ crop_intensity , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,crop_intensity)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(lsci,df.match)

ggplot(df, aes(year, crop_intensity, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="crop_intensity") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


#----------------------------------------------------------------------------------------

lrci <- Land_18_19%>% 
  filter(total_land_cultivated_year>0) %>%
  mutate(NEW_total_land_cult= case_when(
    TreatmentControl=="Control" & land_for_cultivation < total_land_cultivated ~ NA_integer_,
    TRUE ~ total_land_cultivated)) %>% 
  group_by(year,TreatmentControl, household_questionnaire_id) %>%
  summarise(cult=sum(NEW_total_land_cult,na.rm = T),net=mean(land_for_cultivation))%>%
  mutate(ci=cult/net*100) %>% 
  mutate(across(is.numeric, round)) %>% filter(cult>0 & net>0)

names(lrci)[names(lrci) == 'TreatmentControl'] <- 'Group'

lso <-
  lrci %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ ci , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,ci)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(lrci,df.match)

ggplot(df, aes(year, ci, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


```



&nbsp;

\newpage

\noindent
\makebox[\linewidth]{Irrigated land (ha)}  

 **Q** [4.9] Irrigated area out of total land cultivated

```{r irrigated land ,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}
lsi <- land_17_18_19%>% 
  filter(total_land_cultivated_year>0) %>%
  group_by(year,TreatmentControl, household_questionnaire_id) %>%
  summarise(irrigated=sum(irrigated_out_of_tot_land_cult,na.rm = T)*0.0338) %>% 
  mutate(across(is.numeric, round, 2))

names(lsi)[names(lsi) == 'TreatmentControl'] <- 'Group'

lso <-
  lsi %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ irrigated , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,irrigated)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(lsi,df.match)

ggplot(df, aes(year, irrigated, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="irrigated land") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold", 
                                   size=14))


#-----------------------------------------------------------------------------

lsi <- Land_18_19%>% 
  filter(total_land_cultivated_year>0) %>%
  group_by(year,TreatmentControl, household_questionnaire_id) %>%
  summarise(irrigated=sum(irrigated_out_of_tot_land_cult)*0.0338) %>% 
  mutate(across(is.numeric,round,2))

names(lsi)[names(lsi) == 'TreatmentControl'] <- 'Group'

lso <-
  lsi %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ irrigated , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,irrigated)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(lsi,df.match)

ggplot(df, aes(year, irrigated, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14))
```


&nbsp;

&nbsp;


Total irrigation hours of a farmer: 

**Multiply-**  
- Hours needed to irrigate 1 katha  ( _hrs_irr_1katha_ [5.7])  
- No. of irrigation for 1 katha ( _no_of_irrigation_for_1_katha_ [5.8])  
- How much of the cultivated area was under this crop? ( _cult_area_under_crop_[5.5]) 



\noindent
\makebox[\linewidth]{Irrigation hours  - Annually (hr)}  

```{r irrigati,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}

  lsay <- Agriculture_17_18_19%>% 
  group_by(TreatmentControl,year, household_questionnaire_id) %>% 
  summarise(irrigate_hr=sum(irri_for_season)) %>%
  filter(!is.na(irrigate_hr))

names(lsay)[names(lsay) == 'TreatmentControl'] <- 'Group'

lso <-
  lsay %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ irrigate_hr , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,irrigate_hr )%>%
  filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(lsay,df.match) 

ggplot(df, aes(year, irrigate_hr, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="irrigate_hr") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


#--------------------------------------------------------------------------------

lsayr <- Agriculture_18_19%>% 
  group_by(TreatmentControl,year, household_questionnaire_id) %>% 
  summarise(irrigate_hr=sum(irri_for_season)) %>% 
  filter(!is.na(irrigate_hr))


names(lsayr)[names(lsayr) == 'TreatmentControl'] <- 'Group'

lso <-
  lsayr %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ irrigate_hr , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,irrigate_hr)
df.match$Group <- "xMatch"

df <- rbind(lsayr,df.match)

ggplot(df, aes(year, irrigate_hr, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


```


&nbsp;

\newpage


\noindent
\makebox[\linewidth]{Irrigation hours per hectare - Summer (hr)}

```{r  Summer ,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}

lsay <- Agriculture_17_18_19 %>% filter(season_of_crop=="Summer") %>%
  group_by(year,season_of_crop,TreatmentControl,household_questionnaire_id) %>%
  summarise(irrigate_hr=sum(irri_for_season),cult_area=sum(cult_area_under_crop)*0.0339) %>%
  mutate(irrigation_hr_per_ha= irrigate_hr/cult_area) %>%
  filter(!is.na(irrigation_hr_per_ha))

names(lsay)[names(lsay) == 'TreatmentControl'] <- 'Group'

lso <-
  lsay %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ irrigation_hr_per_ha , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[4]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,irrigation_hr_per_ha )%>%
  filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(lsay,df.match) 

ggplot(df, aes(year, irrigation_hr_per_ha, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="income per ha") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))

#------------------------------------------------------------------------------------
  
lsayr <-Agriculture_18_19 %>% filter(season_of_crop=="Summer") %>% 
  group_by(year,season_of_crop,TreatmentControl,household_questionnaire_id) %>%
  summarise(irrigate_hr=sum(irri_for_season),cult_area=sum(cult_area_under_crop)*0.0339) %>%
  mutate(irrigation_hr_per_ha= irrigate_hr/cult_area) %>% 
  filter(!is.na(irrigation_hr_per_ha))


names(lsayr)[names(lsayr) == 'TreatmentControl'] <- 'Group'

lso <-
  lsayr %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ irrigation_hr_per_ha , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[4]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,irrigation_hr_per_ha)
df.match$Group <- "xMatch"

df <- rbind(lsayr,df.match)

ggplot(df, aes(year, irrigation_hr_per_ha, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))

```

&nbsp;

&nbsp;


\noindent
\makebox[\linewidth]{Irrigation hours per hectare - Monsoon (hr)}

```{r  Monsoon ,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}

lsay <- Agriculture_17_18_19 %>% filter(season_of_crop=="Monsoon") %>%
  group_by(year,season_of_crop,TreatmentControl,household_questionnaire_id) %>%
  summarise(irrigate_hr=sum(irri_for_season),cult_area=sum(cult_area_under_crop)*0.0339) %>%
  mutate(irrigation_hr_per_ha= irrigate_hr/cult_area) %>%
  filter(!is.na(irrigation_hr_per_ha))

names(lsay)[names(lsay) == 'TreatmentControl'] <- 'Group'

lso <-
  lsay %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ irrigation_hr_per_ha , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[4]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,irrigation_hr_per_ha )%>%
  filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(lsay,df.match) 

ggplot(df, aes(year, irrigation_hr_per_ha, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="income per ha") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))

#------------------------------------------------------------------------------------
  
lsayr <-Agriculture_18_19 %>% filter(season_of_crop=="Monsoon") %>% 
  group_by(year,season_of_crop,TreatmentControl,household_questionnaire_id) %>%
  summarise(irrigate_hr=sum(irri_for_season),cult_area=sum(cult_area_under_crop)*0.0339) %>%
  mutate(irrigation_hr_per_ha= irrigate_hr/cult_area) %>% 
  filter(!is.na(irrigation_hr_per_ha))


names(lsayr)[names(lsayr) == 'TreatmentControl'] <- 'Group'

lso <-
  lsayr %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ irrigation_hr_per_ha , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[4]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,irrigation_hr_per_ha)
df.match$Group <- "xMatch"

df <- rbind(lsayr,df.match)

ggplot(df, aes(year, irrigation_hr_per_ha, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))



```

&nbsp;
 
 &nbsp;

\noindent
\makebox[\linewidth]{Irrigation hours per hectare - Winter (hr)}

```{r  Winter ,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}

lsay <- Agriculture_17_18_19 %>% filter(season_of_crop=="Winter") %>%
  group_by(year,season_of_crop,TreatmentControl,household_questionnaire_id) %>%
  summarise(irrigate_hr=sum(irri_for_season),cult_area=sum(cult_area_under_crop)*0.0339) %>%
  mutate(irrigation_hr_per_ha= irrigate_hr/cult_area) %>%
  filter(!is.na(irrigation_hr_per_ha))

names(lsay)[names(lsay) == 'TreatmentControl'] <- 'Group'

lso <-
  lsay %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ irrigation_hr_per_ha , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[4]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,irrigation_hr_per_ha )%>%
  filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(lsay,df.match) 

ggplot(df, aes(year, irrigation_hr_per_ha, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="income per ha") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))

#-------------------------------------------------------------------------
  
lsayr <-Agriculture_18_19 %>% filter(season_of_crop=="Winter") %>% 
  group_by(year,season_of_crop,TreatmentControl,household_questionnaire_id) %>%
  summarise(irrigate_hr=sum(irri_for_season),cult_area=sum(cult_area_under_crop)*0.0339) %>%
  mutate(irrigation_hr_per_ha= irrigate_hr/cult_area) %>% 
  filter(!is.na(irrigation_hr_per_ha))


names(lsayr)[names(lsayr) == 'TreatmentControl'] <- 'Group'

lso <-
  lsayr %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ irrigation_hr_per_ha , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[4]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,irrigation_hr_per_ha)
df.match$Group <- "xMatch"

df <- rbind(lsayr,df.match)

ggplot(df, aes(year, irrigation_hr_per_ha, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))

```

***

&nbsp;

\noindent
\makebox[\linewidth]{Fuel use - Annual  (L) [7.16] }  
Total litres of diesel/kerosene consumed for agriculture pumps  in a YEAR
```{r Fuel use - 7.16 ,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}
psf <- Procurement_17_18_19 %>%
  select(year,TreatmentControl,household_questionnaire_id,total_litres_consumed_dieselkero) %>% 
  filter(!is.na(total_litres_consumed_dieselkero))

names(psf)[names(psf) == 'TreatmentControl'] <- 'Group'

lso <-
  psf %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ total_litres_consumed_dieselkero , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,total_litres_consumed_dieselkero)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(psf,df.match)

ggplot(df, aes(year, total_litres_consumed_dieselkero, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="irrigate hr") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


#-------------------------------------------------------------------------------------------

rpsf <- Procurement_18_19 %>%
  select(year,TreatmentControl,household_questionnaire_id,total_litres_consumed_dieselkero) %>% 
  filter(!is.na(total_litres_consumed_dieselkero),
         total_litres_consumed_dieselkero<10000) %>%
  mutate(across(is.numeric, round, 2))

names(rpsf)[names(rpsf) == 'TreatmentControl'] <- 'Group'

lso <-
  rpsf %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ total_litres_consumed_dieselkero , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,total_litres_consumed_dieselkero)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(rpsf,df.match)

ggplot(df, aes(year, total_litres_consumed_dieselkero, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


```


| Rautahat Bara Sarlahi | Control | Treatment |
|------|:-------:|:------:|
| 2018 | 63 | 25 |
| 2019 | 46 | 16 |


```{r Fuel use Annually 6.2 , include=FALSE, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}


# | Saprari district | Control | Treatment |
# |------|:-------:|:------:|
# | 2017 | 47 | 8|
# | 2018 | 46 | 7 |
# | 2019 | 10 | 4 |



# \noindent \makebox[\linewidth]{Fuel use - Annually (L) [6.2]}  

#  **Multiply-**  
#  - How many liters of fuel per hour [6.18a]  
#  - How many days in a season  was the pump used [6.30]  
#  - How many hours per day_ [6.31]  

wemf <- wem_liter_fuel_17_18_19%>%
  filter(!is.na(p123_year)) %>% 
  select(TreatmentControl,year,household_questionnaire_id,p123_year) %>% 
  mutate(across(is.numeric, round)) 

names(wemf)[names(wemf) == 'TreatmentControl'] <- 'Group'

lso <-
  wemf %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ p123_year , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,p123_year)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(wemf,df.match)

ggplot(df, aes(year, p123_year, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="Fuel litre") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


#-----------------------------------------------------------------------------------------
rwemf <- wem_liter_fuel_18_19%>%
  filter(!is.na(p123_year)) %>% 
  select(TreatmentControl,year,household_questionnaire_id,p123_year) %>%
  mutate(across(is.numeric, round))

names(rwemf)[names(rwemf) == 'TreatmentControl'] <- 'Group'

lso <-
  rwemf %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ p123_year , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,p123_year)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(rwemf,df.match)

ggplot(df, aes(year, p123_year, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))

```

```{r Fuel use - Summer 6.2 ,include=FALSE,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}
# {Fuel use - Summer (L) [6.2]}

wemf <- wem_liter_fuel_17_18_19%>%
  filter(!is.na(p123_s)) %>% 
  select(TreatmentControl,year,household_questionnaire_id,p123_s) %>% 
  mutate(across(is.numeric, round)) 

names(wemf)[names(wemf) == 'TreatmentControl'] <- 'Group'

lso <-
  wemf %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ p123_s , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,p123_s)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(wemf,df.match)

ggplot(df, aes(year, p123_s, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="Fuel litre") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


#----------------------------------------------------------------------------------------
  
rwemf <- wem_liter_fuel_18_19%>%
  filter(!is.na(p123_s)) %>% 
  select(TreatmentControl,year,household_questionnaire_id,p123_s) %>%
  mutate(across(is.numeric, round))

names(rwemf)[names(rwemf) == 'TreatmentControl'] <- 'Group'

lso <-
  rwemf %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ p123_s , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,p123_s)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(rwemf,df.match)

ggplot(df, aes(year, p123_s, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))

```

```{r Fuel use - Winter 6.2 ,include=FALSE,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}
# {Fuel use - Winter (L) [6.2]}

wemf <- wem_liter_fuel_17_18_19%>%
  filter(!is.na(p123_w)) %>% 
  select(TreatmentControl,year,household_questionnaire_id,p123_w) %>% 
  mutate(across(is.numeric, round)) 

names(wemf)[names(wemf) == 'TreatmentControl'] <- 'Group'

lso <-
  wemf %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ p123_w , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,p123_w)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(wemf,df.match)

ggplot(df, aes(year, p123_w, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="Fuel litre") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


#------------------------------------------------------------------------------------------

rwemf <- wem_liter_fuel_18_19%>%
  filter(!is.na(p123_w)) %>% 
  select(TreatmentControl,year,household_questionnaire_id,p123_w) %>%
  mutate(across(is.numeric, round))

names(rwemf)[names(rwemf) == 'TreatmentControl'] <- 'Group'

lso <-
  rwemf %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ p123_w , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,p123_w)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(rwemf,df.match)

ggplot(df, aes(year, p123_w, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


```

```{r Fuel use Monsoon 6.2 ,include=FALSE,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}

# {Fuel use - Monsoon (L) [6.2]}

wemf <- wem_liter_fuel_17_18_19%>%
  filter(!is.na(p123_m)) %>% 
  select(TreatmentControl,year,household_questionnaire_id,p123_m) %>% 
  rename(Group = TreatmentControl)


x <- wem_liter_fuel_17_18_19 %>% 
  filter(!is.na(p123_m)) %>%  filter(year==2019) %>% 
  select(household_questionnaire_id) 

x <- inner_join(x,wemf) %>% filter(year==2017)

mf <- wem_liter_fuel_17_18_19%>%
  filter(household_questionnaire_id %in% c(
    "T102007004","T200101003","T100103003","T107607004")) %>% 
  select(TreatmentControl,year,household_questionnaire_id,p123_m) %>% 
  rename(Group = TreatmentControl)
mf$Group <- "Match"

df <- rbind(wemf,mf)

ggplot(df, aes(year, p123_m, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="Fuel litre") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))

#-----------------------------------------------------------------------------------

rwemf <- wem_liter_fuel_18_19%>%
  filter(!is.na(p123_m)) %>% 
  select(TreatmentControl,year,household_questionnaire_id,p123_m) %>%
  mutate(across(is.numeric, round))

names(rwemf)[names(rwemf) == 'TreatmentControl'] <- 'Group'

lso <-
  rwemf %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ p123_m , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,p123_m)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(rwemf,df.match)

ggplot(df, aes(year, p123_m, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


```

\newpage

\noindent
\makebox[\linewidth]{Aquaculture ponds (ha)}
```{r aquaculture ,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}
aquas <- lands_I_17_18_19 %>%
  filter(land_for_aquaculture_ponds>0) %>% 
  mutate(aquaculture_ponds_ha=land_for_aquaculture_ponds*0.0339) %>%
  mutate(across(is.numeric,round,2)) %>% 
  select(year,TreatmentControl,household_questionnaire_id,aquaculture_ponds_ha)
names(aquas)[names(aquas) == 'TreatmentControl'] <- 'Group'

ggplot(aquas, aes(year, aquaculture_ponds_ha, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="aquaculture_ponds_ha") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))
 #------------------------------------------------------------------------------------

raqua <- lands_I_18_19 %>%
  filter(land_for_aquaculture_ponds>0,land_for_aquaculture_ponds<300) %>% 
  mutate(aquaculture_ponds_ha=land_for_aquaculture_ponds*0.0339) %>%
  mutate(across(is.numeric,round,2)) %>% 
  select(year,TreatmentControl,household_questionnaire_id,aquaculture_ponds_ha)

names(raqua)[names(raqua) == 'TreatmentControl'] <- 'Group'

ggplot(raqua, aes(year, aquaculture_ponds_ha, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


```


&nbsp;

&nbsp;

\noindent
\makebox[\linewidth]{Cropping Pattern - Vegetables- Annual   (ha) }
```{r Cropping Pattern Vegetables,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}
veg <- Agriculture_17_18_19 %>% filter(name_of_crop=="Vegetables") %>% 
  group_by(year,TreatmentControl, household_questionnaire_id) %>% 
  summarise(cult_area=sum(cult_area_under_crop)*0.0339) %>% 
  mutate(across( is.numeric,round,2))

names(veg)[names(veg) == 'TreatmentControl'] <- 'Group'

lso <-
  veg %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ cult_area , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,cult_area)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(veg,df.match)

ggplot(df, aes(year, cult_area, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="cultiveted area under crop") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


```
RBS: 1 HH in endline (Treatment)

&nbsp;

&nbsp;

\noindent
\makebox[\linewidth]{Cropping Pattern  - Oilseeds- Annual   (ha)}
```{r Cropping Pattern Oilseeds ,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}
Oil <- Agriculture_17_18_19 %>%filter(name_of_crop=="Oilseeds") %>% 
  group_by(year,TreatmentControl, household_questionnaire_id, name_of_crop) %>% 
  summarise(cult_area=sum(cult_area_under_crop)*0.0339) %>% 
  mutate(across( is.numeric,round,2))

names(Oil)[names(Oil) == 'TreatmentControl'] <- 'Group'

lso <-
  Oil %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ cult_area , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,cult_area)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(Oil,df.match)

ggplot(df, aes(year, cult_area, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="cultiveted area under crop") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


```
RBS: 1 HH in endline (control)

&nbsp;

&nbsp;

\noindent
\makebox[\linewidth]{Cropping Pattern - Paddy - Annual  (ha)}
```{r Paddy ,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}
Paddy <- Agriculture_17_18_19 %>%filter(name_of_crop=="Paddy") %>% 
  group_by(year,TreatmentControl, household_questionnaire_id, name_of_crop) %>% 
  summarise(cult_area=sum(cult_area_under_crop)*0.0339) %>% 
  mutate(across( is.numeric,round,2))

names(Paddy)[names(Paddy) == 'TreatmentControl'] <- 'Group'

lso <-
  Paddy %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ cult_area , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,cult_area)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(Paddy,df.match)

ggplot(df, aes(year, cult_area, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="cultiveted area under crop") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))

#--------------------------------------------------

pwmr <- Agriculture_18_19 %>%
  filter(name_of_crop=="Paddy") %>% 
  group_by(year,TreatmentControl, household_questionnaire_id) %>% 
  summarise(cult_area=sum(cult_area_under_crop)*0.0339) %>% 
  mutate(across( is.numeric,round,2))

names(pwmr)[names(pwmr) == 'TreatmentControl'] <- 'Group'

lso <-
  pwmr %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ cult_area , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,cult_area)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(pwmr,df.match)

ggplot(df, aes(year, cult_area, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


```

&nbsp;

&nbsp;

\noindent
\makebox[\linewidth]{Cropping Pattern - Wheat - Annual  (ha)}
```{r Wheat ,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}
Wheat <- Agriculture_17_18_19 %>%filter(name_of_crop=="Wheat") %>% 
  group_by(year,TreatmentControl, household_questionnaire_id, name_of_crop) %>% 
  summarise(cult_area=sum(cult_area_under_crop)*0.0339) %>% 
  mutate(across( is.numeric,round,2))

names(Wheat)[names(Wheat) == 'TreatmentControl'] <- 'Group'

lso <-
  Wheat %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ cult_area , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,cult_area)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(Wheat,df.match)

ggplot(df, aes(year, cult_area, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="cultiveted area under crop") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))

#--------------------------------------------------

pwmr <- Agriculture_18_19 %>%
  filter(name_of_crop=="Wheat") %>% 
  group_by(year,TreatmentControl, household_questionnaire_id) %>% 
  summarise(cult_area=sum(cult_area_under_crop)*0.0339) %>% 
  mutate(across( is.numeric,round,2))

names(pwmr)[names(pwmr) == 'TreatmentControl'] <- 'Group'

lso <-
  pwmr %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ cult_area , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,cult_area)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(pwmr,df.match)

ggplot(df, aes(year, cult_area, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))


```

&nbsp;

&nbsp;

\noindent
\makebox[\linewidth]{Cropping Pattern - Maize -Annual   (ha)}
```{r Maize ,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}

pwm <- Agriculture_17_18_19 %>%
  filter(name_of_crop=="Maize") %>% 
  group_by(year,TreatmentControl, household_questionnaire_id) %>% 
  summarise(cult_area=sum(cult_area_under_crop)*0.0339) %>% 
  mutate(across( is.numeric,round,2))

names(pwm)[names(pwm) == 'TreatmentControl'] <- 'Group'

lso <-
  pwm %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ cult_area , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,cult_area)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(pwm,df.match)

ggplot(df, aes(year, cult_area, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="cultiveted area under crop") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))



#------------------------------------------------------------
pwmr <- Agriculture_18_19 %>%
  filter(name_of_crop=="Maize") %>% 
  group_by(year,TreatmentControl, household_questionnaire_id) %>% 
  summarise(cult_area=sum(cult_area_under_crop)*0.0339) %>% 
  mutate(across( is.numeric,round,2))

names(pwmr)[names(pwmr) == 'TreatmentControl'] <- 'Group'

lso <-
  pwmr %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ cult_area , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,cult_area)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(pwmr,df.match)

ggplot(df, aes(year, cult_area, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))



```


&nbsp;

&nbsp;


\noindent
\makebox[\linewidth]{Annual income per ha (NPR)} 

**Multiply-**  
 - How much of the cultivated area was under this crop?[5.5]  
 - What was your total harvest ? Unit: per katha [5.9]  
- What percent of the total produce do you sell?[5.11]  
- what was the price per kg from this crop ? [5.12]  

```{r Income ,echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, fig.show="hold", out.width="50%"}

income_ha<- Agriculture_17_18_19 %>% 
  mutate(kg=case_when(
    unit_harvest %in% c(1,2,5) ~37.32,
    unit_harvest == 4 ~100,
    unit_harvest == 3 ~1)) %>% 
  mutate(percent=percent_for_selling/100) %>% 
  mutate(income=what_was_your_total_harvest*cult_area_under_crop*kg*price_per_kg*percent) %>% 
  group_by(TreatmentControl,year, household_questionnaire_id) %>% 
  summarise(income=sum(income,na.rm = T),cult_area=sum(cult_area_under_crop,na.rm = T)*0.0339,income_per_ha=income/cult_area) %>% 
  filter(!is.na(income_per_ha)) %>% mutate(across( is.numeric,round,2))

names(income_ha)[names(income_ha) == 'TreatmentControl'] <- 'Group'

lso <-
  income_ha %>%  mutate(own_sp = Group == "Treatment")

lso_M <- filter(lso, year == 2017)
match.it <- matchit(own_sp ~ income_per_ha , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,income_per_ha)%>% filter(Group=="Control")
df.match$Group <- "Match"

df <- rbind(income_ha,df.match)

ggplot(df, aes(year, income_per_ha, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y="income per ha") +
  scale_x_continuous(breaks = c(2017,2018,2019))+
  theme(legend.position = "none",axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))



#----------------------------------------------------------------------
income2_ha<- Agriculture_18_19 %>% 
    mutate(kg=case_when(
      unit_harvest %in% c(1,2,5) ~37.32,
      unit_harvest == 4 ~100,
      unit_harvest == 3 ~1)) %>% 
    mutate(percent=percent_for_selling/100) %>% 
    mutate(income=what_was_your_total_harvest*cult_area_under_crop*kg*price_per_kg*percent) %>% 
    group_by(TreatmentControl,year, household_questionnaire_id) %>% 
    summarise(income=sum(income,na.rm = T),cult_area=sum(cult_area_under_crop,na.rm = T)*0.0339,income_per_ha=income/cult_area) %>% 
    filter(!is.na(income_per_ha)) %>% mutate(across( is.numeric,round,2)) 

names(income2_ha)[names(income2_ha) == 'TreatmentControl'] <- 'Group'

lso <-
  income2_ha %>% mutate(own_sp = Group == "Treatment") 

lso_M <- filter(lso, year == 2018)
match.it <- matchit(own_sp ~ income_per_ha , data = lso_M, method="nearest", ratio=1)
df.match <- match.data(match.it)[3]
df.match <-
  inner_join (df.match,lso,by="household_questionnaire_id") %>% 
  select(year,Group,household_questionnaire_id,income_per_ha)
df.match$Group <- "xMatch"

df <- rbind(income2_ha,df.match)

ggplot(df, aes(year, income_per_ha, color = Group)) +
  stat_summary(geom = 'line',size=1.1) +
  theme_minimal()+
  labs(x=" ", y=" ") +
  scale_x_continuous(breaks = c(2018,2019))+
  theme(axis.text.x = element_text(face="bold",size=14),axis.text.y = element_text(face="bold",size=16))



```


```{r income2_ha , echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
income2_ha<- Agriculture_18_19 %>% 
    mutate(kg=case_when(
      unit_harvest %in% c(1,2,5) ~37.32,
      unit_harvest == 4 ~100,
      unit_harvest == 3 ~1)) %>% 
    mutate(percent=percent_for_selling/100) %>% 
    mutate(income=what_was_your_total_harvest*cult_area_under_crop*kg*price_per_kg*percent) %>% 
    group_by(TreatmentControl,year, household_questionnaire_id) %>% 
    summarise(income=sum(income,na.rm = T),cult_area=sum(cult_area_under_crop,na.rm = T)*0.0339,income_per_ha=income/cult_area/1000) %>% 
    filter(!is.na(income_per_ha))  %>% 
  summarise(Mean=mean(income_per_ha)) %>% mutate(across( is.numeric,round,2))

x <- spread(income2_ha, TreatmentControl, Mean)

kable(x, align = "c",  booktabs = T) %>%
  kable_styling(full_width = F, position = "right") %>%
  column_spec(1, bold = T) %>%
  collapse_rows(columns = 1, valign = "top") %>% 
  add_header_above(c(" ", "RBS" =1 , " " = 1))


```
